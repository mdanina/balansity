# üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **Retry Limit —Å Exponential Backoff** –≤ queue worker
2. **Sentry –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ production –æ—à–∏–±–æ–∫

## üì¶ –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
```bash
npm install
```

–≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç `@sentry/react`, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ `package.json`.

### Queue Worker:
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - –≤—Å–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.

## üîß –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Sentry (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 2.1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Sentry

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [sentry.io](https://sentry.io) (–µ—Å—Ç—å free –ø–ª–∞–Ω)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç:
   - Platform: **React**
   - Framework: **React**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **DSN** –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 2.2. –î–æ–±–∞–≤—å—Ç–µ DSN –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ `.env.production`:

```env
VITE_SENTRY_DSN=https://your-key@sentry.io/your-project-id
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π DSN –∏–∑ Sentry Dashboard.

## üèóÔ∏è –®–∞–≥ 3: –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
```bash
npm run build
```

### Queue Worker:
```bash
cd queue-worker
npm run build
```

## üöÄ –®–∞–≥ 4: –î–µ–ø–ª–æ–π

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ `dist/` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env.production` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `VITE_SENTRY_DSN`

### Queue Worker:
1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ PM2:
   ```bash
   cd queue-worker
   npm run restart:pm2
   ```

   –ò–ª–∏ —á–µ—Ä–µ–∑ Docker:
   ```bash
   docker-compose restart
   ```

## ‚úÖ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞

### Retry Logic:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ queue worker:
   ```bash
   pm2 logs balansity-queue-worker
   ```

2. –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ø—ã—Ç–æ–∫:
   ```
   [INFO] Processing email task (attempt 1/5): user@example.com
   [WARN] Failed to send email, will retry (attempt 2/5)
   ```

### Sentry:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [sentry.io](https://sentry.io) –∏ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. –í —Ä–∞–∑–¥–µ–ª–µ **Issues** –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è –æ—à–∏–±–∫–∏ –∏–∑ production
3. –ü—Ä–∏ –æ—à–∏–±–∫–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Retry Limits:

–í `.env` queue worker –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

```env
MAX_EMAIL_RETRY_ATTEMPTS=5      # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 5
MAX_PAYMENT_RETRY_ATTEMPTS=5    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 5
MAX_REPORT_RETRY_ATTEMPTS=3     # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 3
```

### Sentry:

–í `.env.production`:

```env
VITE_SENTRY_DSN=https://your-dsn@sentry.io/project-id
VITE_SENTRY_ENABLE_IN_DEV=false  # true –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ dev
```

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `RETRY_LOGIC_DOCUMENTATION.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ retry
- `SENTRY_SETUP.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Sentry
- `IMPLEMENTATION_SUMMARY.md` - –∏—Ç–æ–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

**–ì–æ—Ç–æ–≤–æ! –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç!** ‚úÖ


